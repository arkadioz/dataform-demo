config {
    type: "incremental",
    name: "used_bicycles",
    dependencies: ["available_bicycles_dataform"]
}

SELECT
  bicycle_id AS bike_id,
  manufacturer,
  current_date AS creation_date,
  CAST(NULL AS json) AS DATA,
  color,
  CURRENT_DATETIME AS creation_date_time
  
FROM
  ${ref("available_bicycles_dataform")}
WHERE
  bicycle_id IS NOT NULL
